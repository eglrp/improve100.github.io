pache HTTP Server 基础（一）
2014-07-29 12:49:28
标签：配置文件 区分大小写 虚拟主机 Apache
原创作品，允许转载，转载时请务必以超链接形式标明文章 原始出处 、作者信息和本声明。否则将追究法律责任。http://skypegnu1.blog.51cto.com/8991766/1532126
一、Apache简介与特性

     Apache HTTP Server（简称Apache）是Apache软件基金会开发的一个开放源码的网页服务器，由于其多平台和安全性被广泛使用，是最流行的Web服务器端软件之一（可以说是web服务器的规范）。Apache的特点是简单、速度快、性能稳定，并可做代理服务器来使用。
           Apache Web服务器软件拥有以下特性： 
	   支持最新的HTTP/1.1协议 
	   模块化设计，核心非常小，各种功能都通过模块添加，支持运行时配置，支持单独编译模块
	   拥有简单而强有力的基于文件的配置过程 
	   支持通用网关接口（CGI）
	   支持多种形式的虚拟主机配置 
	   支持多种方式的HTTP认证 
	   支持实时监视服务器状态和定制服务器日志
	   支持服务器端包含指令(SSI) ， 支持安全Socket层(SSL)
	   提供用户会话过程的跟踪 
	   支持FastCGI 
	   支持每目录的访问控制
	   支持URL重写

	   二、其他流行的web服务器

	       不可否认，Apache是一个优秀的全能Web服务器，但对于那些需要更强大的Web应用服务器（比如大小、可定制、响应速度、可扩展性等方面）的人而言，Apache明显不符合他们的要求，寻找Apache的替代者是更好的选择。
	           下面所列出的是当前可以替代Apache的几个热门Web应用服务器，他们的特点和适用的应用场景各不相同，但都是针对Apache所不够擅长的某一方面设计的。但是就其稳定性，特性支持，功能性而言，apache是当之无愧的老大。
		   1、Lighttpd
		       最流行的Apache服务器替代者，Lighttpd是一个单线程的针对大量持续连接做出专门优化的Web服务器（这正是多数高流量网站和应用程序需要的）。众多的流行Web站点选择Lighttpd，包括Youtube、SourceForge和维基百科。Lighttpd支持FastCGI、HTTP服务器端压缩、mod-rewrite和其他众多有用的功能。尽管Lighttpd拥有Apache的绝大多数功能，但它仍然保持轻量级（仅1MB）并且可以与Apache使用相同的配置。 
		       2、Nginx
		           Nginx是一个来自俄罗斯的流行的Web应用服务器，它被应用于大量的俄罗斯的高并发站点，俄罗斯的搜索引擎网站Rambler就是基于Nginx构建的。Nginx对静态页面的支持相当出色，轻量且免费。Nginx不支持CGI，但是支持更灵活的FastCGI。

			   三、apache httpd （httpd 2.2）安装和基本概述

			   httpd 安装通常有两种方式：
			   通过 yum 安装，优点：安装过程简单；缺点：可能编译了不需要的模块，或者没有编译自己需要的模块，而且其版本都比较老。
			   通过源码编译安装，优点：灵活，可定制型强；缺点：较为复杂，而且编译时间比较长
			       这里纯粹是为了学习，所以就偷懒，直接用 yum 一下就搞定，如果是生产环境，就不要这么草率了。在安装之前，先关闭iptables, SELinux，以免造成一些麻烦。 
			       1
			       2
			       3
			       4
			       5
			       6
			       7
			       8
			       9
			       10
			       11
			       12
			       13
			       14
			       15
			       16
			       17
			       18
			       19
			       20
			       21
			       22
			       23
			       24
			       25
			       ## 先关闭 iptables,以及 SELinux
			       # service iptables stop
			       # chkconfig iptables off
			        
			       # setenforce 0
			       # sed 's/SELINUX=enforcing/SELINUX=disabled/' /etc/sysconfig/selinux
			        
			       ## 安装 httpd
			       # yum -y install httpd
			        
			       ## 启动 httpd 服务，并加入开机自启动
			       # service httpd start
			       # netstat -tulpn | grep httpd
			       tcp        0      0 :::80     :::*          LISTEN      1544/httpd 
			        
			       # ps -ef | grep httpd
			       root      1544     1  0 18:27 ?        00:00:00 /usr/sbin/httpd    ## 注意这里的不同
			       apache    1546  1544  0 18:27 ?        00:00:00 /usr/sbin/httpd
			       apache    1547  1544  0 18:27 ?        00:00:00 /usr/sbin/httpd
			       apache    1548  1544  0 18:27 ?        00:00:00 /usr/sbin/httpd
			       apache    1549  1544  0 18:27 ?        00:00:00 /usr/sbin/httpd
			       apache    1550  1544  0 18:27 ?        00:00:00 /usr/sbin/httpd
			       apache    1551  1544  0 18:27 ?     ons. 
			        
			       # If only a port number is specified in the Listen directive, the server listens to the given port on allinterfaces. 
			        
			       # If an IP address is given as well as a port,the server will listen on the given port and interface. 
			        
			       # Multiple Listen directives may be used to specify a number of addresses andports to listen on. The server will respond to requests from any of the listedaddresses and ports.
			       注意：Listen指令可以重复使用，如果需要监听多个端口，则必须写多行Listen指令

			       2、配置服务器HTTP响应头
			       语法：ServerTokens  Major|Minor|Minimal|ProductOnly|OS|Full
			       说明：此指令控制Server回送给客户端的响应头域是否包含关于服务器相关的描述信息。
			       wKiom1PXBjzz1L7uAADvJVWEepY584.jpg
			       注意：此设置将作用于整个服务器，而且不能在虚拟主机的层次启用或禁用。

			       3、设置连接超时与长连接
			           Timeout  这个超时参数只是前后两次tcp传输包的间隔(指两个tcp包之间的超时时间.),如果大于这个间隔,apache就主动关闭tcp连接.　http://blog.chinaunix.net/uid-18868906-id-3952394，不管是否关闭 KeepAlive 功能，服务器性能不伤可以应用在.htaccess文件中，也就是.htaccess中的配置能否覆盖主配置文件中的指令，使.htaccess中的指令生效
				    
				   AllowOverride       
				       None               # .htaccess文件将被完全忽略  
				           Option             # 允许使用控制目录特征的指令.他们包括Options 和XBitHack
					       FileInfo           # FileInfo 允许使用文件控制类型的指令。它们包括AddEncoding AddLanguage  AddType  DEfaultType ErrorDocument LanguagePriority
					           AuthConfig         # 允许使用所有的权限指令，他们包括AuthDBMGroupFile AuthDBMUserFile  AuthGroupFile  AuthName AuthTypeAuthUserFile和Require
						       Limit              # 允许使用权限控制指令。它们包括Allow Deny和Order
						           Index              # 允许使用目录控制类型的指令。它们包括AddDescription  AddIcon  AddIconByEncoding AddIconByType  DefaultIcon  DirectoryIndex  FancyIndexing  HeaderName  IndexIgnore  IndexOptions ReadmeName
							     
							   ### 访问权限 ###
							   Order allow,deny   #这两行都是基于IP访问控制的, 后面一项是默认选项（这里是deny）
							   Allow from all     
							   </Directory>

							   作用：限制访问站点资源的客户端来源，即设置允许或拒绝访问服务器资源的来源主机。
							   配置指令：
							           Order allow,deny|deny,allow
								            Allow from  all | IP地址 | 网络号       # 定义允许列表，白名单
									             Deny from  all | IP地址 | 网络号       # 定义拒绝列表，黑名单
										              指令说明：Order指令是用来定义allow和deny哪一个为。
											      如果把CustomLog或ErrorLog指令放在<VirtualHost>段内，所有对这个虚拟主机的请求和错误信息会被记录在其私有的日志文件中，那些没有在<VirtualHost>段内使用日志指令的虚拟主机将仍然和主服务器使用同一个日志。

											       即使一个并不繁忙的服务器，其日志文件的信息量也会很大，一般每10000个请求，访问日志就会增加1MB或更多。这就有必要定期滚动日志文件。由于ABase64编码，很容易被窃取。摘要认证的安全æ<65;34;26M
